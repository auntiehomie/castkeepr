{"version":3,"file":"processEntrypoint.js","names":["isAborted","processEntrypoint","only","log","entrypoint","_stack","abortSignal","_using","createAbortSignal","undefined","result","getNext","assertNotSuperseded","setTransformResult","_","_error","_hasError","_dispose","e","supersededWith"],"sources":["../../../src/transform/generators/processEntrypoint.ts"],"sourcesContent":["import { isAborted } from '../actions/AbortError';\nimport type { IProcessEntrypointAction, SyncScenarioForAction } from '../types';\n\n/**\n * The first stage of processing an entrypoint.\n * This stage is responsible for:\n * - scheduling the explodeReexports action\n * - scheduling the transform action\n * - rescheduling itself if the entrypoint is superseded\n */\nexport function* processEntrypoint(\n  this: IProcessEntrypointAction\n): SyncScenarioForAction<IProcessEntrypointAction> {\n  const { only, log } = this.entrypoint;\n  log('start processing (only: %o)', only);\n\n  try {\n    using abortSignal = this.createAbortSignal();\n\n    yield ['explodeReexports', this.entrypoint, undefined, abortSignal];\n    const result = yield* this.getNext(\n      'transform',\n      this.entrypoint,\n      undefined,\n      abortSignal\n    );\n\n    this.entrypoint.assertNotSuperseded();\n\n    this.entrypoint.setTransformResult(result);\n\n    log('entrypoint processing finished');\n  } catch (e) {\n    if (isAborted(e) && this.entrypoint.supersededWith) {\n      log('processing aborted, schedule the next attempt');\n      yield* this.getNext(\n        'processEntrypoint',\n        this.entrypoint.supersededWith,\n        undefined,\n        null\n      );\n\n      return;\n    }\n\n    log(`Unhandled error: %O`, e);\n    throw e;\n  }\n}\n"],"mappings":";;;AAAA,SAASA,SAAS,QAAQ,uBAAuB;AAGjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,UAAUC,iBAAiBA,CAAA,EAEiB;EACjD,MAAM;IAAEC,IAAI;IAAEC;EAAI,CAAC,GAAG,IAAI,CAACC,UAAU;EACrCD,GAAG,CAAC,6BAA6B,EAAED,IAAI,CAAC;EAExC;IAAA,IAAI;MAAA,IAAAG,MAAA;MACF,MAAMC,WAAW,GAAAC,MAAA,CAAAF,MAAA,EAAG,IAAI,CAACG,iBAAiB,CAAC,CAAC;MAE5C,MAAM,CAAC,kBAAkB,EAAE,IAAI,CAACJ,UAAU,EAAEK,SAAS,EAAEH,WAAW,CAAC;MACnE,MAAMI,MAAM,GAAG,OAAO,IAAI,CAACC,OAAO,CAChC,WAAW,EACX,IAAI,CAACP,UAAU,EACfK,SAAS,EACTH,WACF,CAAC;MAED,IAAI,CAACF,UAAU,CAACQ,mBAAmB,CAAC,CAAC;MAErC,IAAI,CAACR,UAAU,CAACS,kBAAkB,CAACH,MAAM,CAAC;MAE1CP,GAAG,CAAC,gCAAgC,CAAC;IACvC,CAAC,QAAAW,CAAA;MAAA,IAAAC,MAAA,GAAAD,CAAA;MAAA,IAAAE,SAAA;IAAA;MAAAC,QAAA,CAAAZ,MAAA,EAAAU,MAAA,EAAAC,SAAA;IAAA;EAAA,EAAC,OAAOE,CAAC,EAAE;IACV,IAAIlB,SAAS,CAACkB,CAAC,CAAC,IAAI,IAAI,CAACd,UAAU,CAACe,cAAc,EAAE;MAClDhB,GAAG,CAAC,+CAA+C,CAAC;MACpD,OAAO,IAAI,CAACQ,OAAO,CACjB,mBAAmB,EACnB,IAAI,CAACP,UAAU,CAACe,cAAc,EAC9BV,SAAS,EACT,IACF,CAAC;MAED;IACF;IAEAN,GAAG,CAAE,qBAAoB,EAAEe,CAAC,CAAC;IAC7B,MAAMA,CAAC;EACT;AACF"}