{"version":3,"file":"processEntrypoint.js","names":["_AbortError","require","dispose_SuppressedError","r","e","SuppressedError","suppressed","error","stack","Error","prototype","Object","create","constructor","value","writable","configurable","_dispose","s","next","length","o","pop","p","d","call","v","a","Promise","resolve","then","err","_using","n","TypeError","Symbol","asyncDispose","for","dispose","push","processEntrypoint","only","log","entrypoint","_stack","abortSignal","createAbortSignal","undefined","result","getNext","assertNotSuperseded","setTransformResult","_","_error","_hasError","isAborted","supersededWith"],"sources":["../../../src/transform/generators/processEntrypoint.ts"],"sourcesContent":["import { isAborted } from '../actions/AbortError';\nimport type { IProcessEntrypointAction, SyncScenarioForAction } from '../types';\n\n/**\n * The first stage of processing an entrypoint.\n * This stage is responsible for:\n * - scheduling the explodeReexports action\n * - scheduling the transform action\n * - rescheduling itself if the entrypoint is superseded\n */\nexport function* processEntrypoint(\n  this: IProcessEntrypointAction\n): SyncScenarioForAction<IProcessEntrypointAction> {\n  const { only, log } = this.entrypoint;\n  log('start processing (only: %o)', only);\n\n  try {\n    using abortSignal = this.createAbortSignal();\n\n    yield ['explodeReexports', this.entrypoint, undefined, abortSignal];\n    const result = yield* this.getNext(\n      'transform',\n      this.entrypoint,\n      undefined,\n      abortSignal\n    );\n\n    this.entrypoint.assertNotSuperseded();\n\n    this.entrypoint.setTransformResult(result);\n\n    log('entrypoint processing finished');\n  } catch (e) {\n    if (isAborted(e) && this.entrypoint.supersededWith) {\n      log('processing aborted, schedule the next attempt');\n      yield* this.getNext(\n        'processEntrypoint',\n        this.entrypoint.supersededWith,\n        undefined,\n        null\n      );\n\n      return;\n    }\n\n    log(`Unhandled error: %O`, e);\n    throw e;\n  }\n}\n"],"mappings":"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"}